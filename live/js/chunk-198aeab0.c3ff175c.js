(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-198aeab0"],{1029:function(e,t,i){},8515:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var a=function(e,t){return e.map((function(e,t){return[t,e]})).sort(function(e,t){return this(e[1],t[1])||e[0]-t[0]}.bind(t)).map((function(e){return e[1]}))}},"9b37":function(e,t,i){"use strict";i("1029")},db24:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{},[i("div",{},[i("b-tabs",{attrs:{card:""}},[i("b-tab",{staticClass:"p-0",attrs:{title:e.$t("Part")+" 1"},on:{click:function(t){return e.$router.push({name:"team-performance-individual",params:{id:e.id,performance_id:e.performance_id,tabIdx:0}})}}}),i("b-tab",{staticClass:"p-0",attrs:{title:e.$t("Part")+" 2"},on:{click:function(t){return e.$router.push({name:"team-performance-individual",params:{id:e.id,performance_id:e.performance_id,tabIdx:1}})}}}),i("b-tab",{staticClass:"p-0",attrs:{title:e.$t("Part")+" 3"},on:{click:function(t){return e.$router.push({name:"team-performance-individual",params:{id:e.id,performance_id:e.performance_id,tabIdx:2}})}}}),i("b-tab",{staticClass:"p-0",attrs:{title:e.$t("Part")+" 4"},on:{click:function(t){return e.$router.push({name:"team-performance-individual",params:{id:e.id,performance_id:e.performance_id,tabIdx:3}})}}}),i("b-tab",{staticClass:"p-0",attrs:{title:e.$t("Summary Score")},on:{click:function(t){return e.$router.push({name:"team-performance-individual",params:{id:e.id,performance_id:e.performance_id,tabIdx:4}})}}})],1)],1),0!==e.scoreCards.length?i("div",{staticClass:"d-flex"},e._l(e.allPart,(function(t){return i("div",{key:t.id,staticClass:"mt-1 mr-1 mb-2",class:0===e.scoreCards.length?"":"pointer",style:t.id===e.currentPart.id?{"border-bottom":"3.5px solid #FF0000"}:{},on:{click:function(i){0!==e.scoreCards.length&&(e.currentPart=t)}}},[i("span",{style:[0===e.scoreCards.length?{color:"black",opacity:"0.6"}:{color:"black"}]},[e._v(e._s(e.$t(t.title)))])])})),0):i("div"),0!==e.scoreCards.length?i("div",{staticClass:"p-1 d-flex flex-column",staticStyle:{"background-color":"white"}},[i("div",{attrs:{name:"fade-custom",mode:"out-in"}},["setKra"===e.currentPart.id?i("div",{key:"currentPartSet",staticClass:"d-flex align-items-center justify-content-between"},[i("div",{staticClass:"formTitle"},[e._v(" "+e._s(e.$t("Performance Planning"))+" ")])]):"review"===e.currentPart.id?i("div",{key:"currentPartReview",staticClass:"d-flex align-items-center justify-content-between"},[i("span",{staticClass:"formTitle"},[e._v(" "+e._s(e.$t("Performance Review"))+" ")])]):"evaluation"===e.currentPart.id?i("div",{key:"currentPartEvaluation",staticClass:"d-flex align-items-center justify-content-between"},[i("span",{staticClass:"formTitle"},[e._v(" "+e._s(e.$t("Year End Result"))+" ")]),i("div",{staticClass:"d-flex align-items-center justify-content-center mr-1"},[!e.isSubmitted&&1!==e.roles.selectedRole&&3!==e.roles.selectedRole&&(4!==e.roles.selectedRole||e.division&&e.section||1!==e.isSupervisor)&&5!==e.roles.selectedRole?e._e():i("div",[i("b-button",{staticClass:"saj-button",staticStyle:{"margin-right":"10px"},style:e.isApproveSV||e.isApproveHOD||e.isApproveSHR?"":"display: none;",attrs:{variant:"primary"},on:{click:function(t){return e.toggleInput()}}},[e._v(" "+e._s(e.disableRating?e.$t("Edit"):e.$t("Cancel"))+" ")]),i("button",{staticClass:"btn btn-primary",style:e.isApproveSV||e.isApproveHOD||e.isApproveSHR?"":"display: none;",attrs:{disabled:0===e.scoreCards.length},on:{click:function(t){e.saveResult(),e.toggleInput()}}},[e._v(" "+e._s(e.$t("Save Changes"))+" ")])],1)])]):e._e(),"evaluation"===e.currentPart.id?i("div",{staticClass:"row d-flex justify-content-end m-1"},[3===e.grade_set_id||4===e.grade_set_id?i("div",{staticClass:"saj-title mt-1 d-flex justify-content-end"},[e._v(" "+e._s(e.total_score_exec)+"/"+e._s(e.kra_weightage)+" % ")]):e._e(),1===e.grade_set_id||2===e.grade_set_id?i("div",{staticClass:"saj-title mt-1 d-flex justify-content-end"},[e._v(" "+e._s(e.total_score_top)+"/"+e._s(e.kra_weightage)+" % ")]):e._e()]):e._e()]),"setKra"!==e.currentPart.id||e.isSubmitted||4!==!e.roles.selectedRole?e._e():i("div",{staticClass:"saj-text btn btn-primary mt-1",staticStyle:{width:"25rem"},on:{click:function(t){return e.addScoreBoard()}}},[e._v(" "+e._s(e.$t("Create Department's Objective / Initiative"))+" ")]),i("div",{staticClass:"mt-2 d-flex flex-column px-1"},[e.scoreCards.length>0?[i("transition-group",{attrs:{name:"list",mode:"out-in"}},[e._l(e.scoreCards,(function(t,a){return i("div",{key:t.id,staticClass:"mb-1",staticStyle:{position:"relative",background:"#F7F7FC","border-radius":"6px"}},[i("transition",{attrs:{name:"zoom-out",mode:"out-in"}},[e.isReadOnly||e.isSubmitted||!e.isSubmitted?e._e():[i("div",{key:"removeSpecificScoreBoard",staticStyle:{position:"absolute",right:"-5px",top:"-10px","background-color":"white","border-radius":"50%"},on:{click:function(i){return e.removeSpecificScoreBoard({id:t.id,index:a})}}},[i("feather-icon",{staticStyle:{color:"#C5C7CD"},attrs:{icon:"MinusCircleIcon",size:"20"}})],1)]],2),i("div",{staticClass:"d-flex align-items-center justify-content-between pointer p-2",on:{click:function(e){t.visible=!t.visible}}},[i("span",{staticClass:"saj-text"},[e._v(e._s(e.$t(t.title))+" "+e._s(a+1))]),i("feather-icon",{staticStyle:{color:"#6E6B7B"},attrs:{icon:t.visible?"ChevronUpIcon":"ChevronDownIcon",size:"20"}})],1),i("validation-observer",{ref:"validateKRA",refInFor:!0},[i("b-collapse",{model:{value:t.visible,callback:function(i){e.$set(t,"visible",i)},expression:"scoreCard.visible"}},[i("div",{staticClass:"px-1",class:e.isReadOnly?"pb-2":""},[i("validation-provider",{attrs:{name:e.$t("objective"),rules:"required"},scopedSlots:e._u([{key:"default",fn:function(a){var s=a.errors;return[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"scoreCard.description"}],staticClass:"custom-formcontrol-none mt-1",staticStyle:{width:"100%","min-height":"70px",background:"#EEEEEE"},attrs:{disabled:!0},domProps:{value:t.description},on:{input:function(i){i.target.composing||e.$set(t,"description",i.target.value)}}}),e._v(" "),i("small",{staticClass:"text-danger",staticStyle:{"font-family":"Poppins"}},[e._v(e._s(s[0]))])]}}],null,!0)}),i("transition-group",{attrs:{name:"list",mode:"out-in"}},e._l(t.KRA,(function(s,r){return i("div",{key:s.id,staticClass:"p-1 mb-1",staticStyle:{background:"#efedee","border-radius":"6px"}},[i("div",{staticClass:"d-flex align-items-center justify-content-between pointer",on:{click:function(e){s.visible=!s.visible}}},[i("span",{staticClass:"saj-text"},[e._v(" "+e._s(e.$t("KEY RESULT AREA")))]),i("feather-icon",{staticStyle:{color:"#6E6B7B"},attrs:{icon:s.visible?"ChevronUpIcon":"ChevronDownIcon",size:"20"}})],1),i("b-collapse",{model:{value:s.visible,callback:function(t){e.$set(s,"visible",t)},expression:"KRA.visible"}},[i("div",{staticClass:"mt-2 mb-2"},[i("div",{staticClass:"d-flex  justify-content-between align-items-center",staticStyle:{"margin-bottom":"25px"}},[i("div",{staticClass:"d-flex flex-column",staticStyle:{width:"100%"}},[i("validation-provider",{attrs:{name:e.$t("KRA"),rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.errors;return[i("textarea",{directives:[{name:"model",rawName:"v-model",value:s.description,expression:"KRA.description"}],staticClass:"custom-formcontrol-none",staticStyle:{width:"100%","min-height":"70px"},attrs:{disabled:!0},domProps:{value:s.description},on:{input:function(t){t.target.composing||e.$set(s,"description",t.target.value)}}}),e._v(" "),i("small",{staticClass:"text-danger",staticStyle:{"font-family":"Poppins"}},[e._v(e._s(a[0]))])]}}],null,!0)}),i("div",{staticClass:"d-flex flex-column"},[i("transition-group",{attrs:{name:"list",mode:"out-in"}},[[i("div",{key:s.id+"+target",staticClass:"mt-1 d-flex justify-content-between align-items-center"},[i("div",{staticClass:"p-1",staticStyle:{background:"#f7f7fd","border-radius":"6px",width:"100%"}},[[i("div",[i("comp-target",{attrs:{measurement:s.target.measurement,target:s.target.target,date:s.target.due,"current-part":e.currentPart,"is-file-kra":s.target.isFileKra,"is-submitted":e.isSubmitted,"is-user-i-d":e.userId},on:{"update:measurement":function(t){return e.$set(s.target,"measurement",t)},"update:target":function(t){return e.$set(s.target,"target",t)},"update:date":function(t){return e.$set(s.target,"due",t)}}})],1)]],2)])],e.isShowAchievement?[i("div",{key:s.id+"+achievement",staticClass:"mt-1 d-flex justify-content-between align-items-center"},[i("div",{staticClass:"p-1",staticStyle:{background:"#f7f7fd","border-radius":"6px",width:"100%"}},[[i("div",[i("comp-achievement",{attrs:{tracking:s.achievement.tracking,achievement:s.achievement.achievement,yearachievement:s.achievement.yearachievement,attachment:s.achievement.file,resultattachment:s.achievement.resultfile,"is-file":s.achievement.isFile,"is-file-result":s.achievement.isFileResult,achievement_to_date:s.achievement.achievement_to_date,"current-part":e.currentPart,"is-submitted":e.isSubmitted,"is-user-i-d":e.userId},on:{"update:tracking":function(t){return e.$set(s.achievement,"tracking",t)},"update:achievement":function(t){return e.$set(s.achievement,"achievement",t)},"update:yearachievement":function(t){return e.$set(s.achievement,"yearachievement",t)},"update:attachment":function(t){return e.$set(s.achievement,"file",t)},"update:resultattachment":function(t){return e.$set(s.achievement,"resultfile",t)},"update:achievement_to_date":function(t){return e.$set(s.achievement,"achievement_to_date",t)}}})],1)]],2)])]:e._e()],2)],1)],1),i("transition",{attrs:{name:"zoom-out",mode:"out-in"}},[e.isReadOnly||e.isSubmitted||!e.isSubmitted?e._e():[i("feather-icon",{staticClass:"ml-2",staticStyle:{color:"#C5C7CD"},attrs:{icon:"MinusCircleIcon",size:"35"},on:{click:function(i){return e.removeSpecificKRa({id:t.id,index:a},{id:s.id,index:r})}}})]],2)],1),i("hr",{staticStyle:{"border-top":"1px solid #D5D5D5",width:"100%"}}),i("div",{staticClass:"d-flex"},[i("div",{staticClass:"d-flex flex-column",staticStyle:{width:"100%"}},[i("span",{staticClass:"saj-text"},[e._v(e._s(e.$t("Remarks")))]),i("textarea",{directives:[{name:"model",rawName:"v-model",value:s.remark,expression:"KRA.remark"}],staticClass:"custom-formcontrol-none",staticStyle:{width:"100%","min-height":"70px","margin-bottom":"10px","margin-top":"10px"},attrs:{disabled:!0},domProps:{value:s.remark},on:{input:function(t){t.target.composing||e.$set(s,"remark",t.target.value)}}})]),i("transition",{attrs:{name:"zoom-out",mode:"out-in"}},[e.isShowSelfScore?[i("div",{key:"selfScore",staticClass:"ml-2 self-score"},[i("span",{staticStyle:{"margin-left":"0.3rem"}},[e._v(e._s(e.$t("Self Score"))+":")]),i("b-form-rating",{staticClass:"pl-0",staticStyle:{background:"none"},attrs:{disabled:!0,"no-border":"","show-value":"",inline:"",color:"#DFB300",stars:"6",size:"lg"},model:{value:s.self_score,callback:function(t){e.$set(s,"self_score",t)},expression:"KRA.self_score"}}),i("br"),i("span",{staticStyle:{"margin-left":"0.3rem"}},[e._v(e._s(e.$t("Manager Score"))+":")]),i("b-form-rating",{staticClass:"pl-0",staticStyle:{background:"none"},attrs:{"show-clear":"","no-border":"","show-value":"",inline:"",color:"#DFB300",stars:"6",size:"lg",disabled:e.disableRating},model:{value:s.manager_rating,callback:function(t){e.$set(s,"manager_rating",t)},expression:"KRA.manager_rating"}}),i("span",{staticStyle:{"margin-top":"5px","margin-right":"15px"}},["1"==s.manager_rating?i("h5",[e._v(e._s(e.isEnglish?e.rating[5].definition_en:e.rating[5].definition_my))]):"2"==s.manager_rating?i("h5",[e._v(e._s(e.isEnglish?e.rating[4].definition_en:e.rating[4].definition_my))]):"3"==s.manager_rating?i("h5",[e._v(e._s(e.isEnglish?e.rating[3].definition_en:e.rating[3].definition_my))]):"4"==s.manager_rating?i("h5",[e._v(e._s(e.isEnglish?e.rating[2].definition_en:e.rating[2].definition_my))]):"5"==s.manager_rating?i("h5",[e._v(e._s(e.isEnglish?e.rating[1].definition_en:e.rating[1].definition_my))]):"6"==s.manager_rating?i("h5",[e._v(e._s(e.isEnglish?e.rating[0].definition_en:e.rating[0].definition_my))]):e._e()])],1)]:e._e()],2)],1)])])],1)})),0),i("transition",{attrs:{name:"zoom-out",mode:"out-in"}},[e.isReadOnly||e.isSubmitted||!e.isSubmitted?e._e():[i("div",{key:"addKRA",staticClass:"mt-1 d-flex align-items-center justify-content-center"},[i("feather-icon",{staticClass:"ml-2 mb-1",staticStyle:{color:"#C5C7CD"},attrs:{icon:"PlusCircleIcon",size:"35"},on:{click:function(i){return e.addKRA({id:t.id,index:a})}}})],1)]],2)],1)])],1)],1)})),0===e.scoreCards.length?i("div",{key:"emptyScoreBoard"},[i("span",{staticStyle:{}},[e._v("No score card yet. Please create your score card. ")])]):e._e()],2)]:e._e()],2)]):i("div",[i("div",{staticClass:"saj-text d-flex align-items-center justify-content-center bg-white p-1 m-0 mb-3 mt-3",staticStyle:{"font-style":"italic",background:"#ffffff","text-align":"center",height:"500px","border-radius":"20px","box-shadow":"0px 0px 41px 9px rgba(0, 0, 0, 0.11)"}},[e._v(" "+e._s(e.$t("Key Result Area are not available"))+" ")])])])},s=[],r=i("5843"),n=i("db6c"),o=i("f902"),l=i("6190"),c=i("1947"),d=i("b9b9"),u=i("2616"),h=i("ec82"),m=i("ba85"),p=i("2ef0"),v=i.n(p),g=i("7bb1"),_=i("8f03"),f=i("e009"),b=i("2f62"),k=i("206d"),$={components:{BCollapse:r["a"],CompTarget:h["a"],CompAchievement:m["a"],BFormRating:n["a"],ValidationProvider:g["b"],ValidationObserver:g["a"],BTabs:o["a"],BTab:l["a"],BButton:c["a"]},directives:{"b-popover":d["a"],"b-tooltip":u["a"],Ripple:f["a"]},props:{division:{type:null,default:null},section:{type:null,default:null}},data(){return{isSuccessResult:!1,performance_id:this.$route.params.performance_id,id:this.$route.params.id,isSupervisor:null,grade_set_id:null,subsidiary_id:null,kra_weightage:null,required:_["b"],manager_rating:0,allPart:[{title:"Performance Planning",id:"setKra"},{title:"Performance Review",id:"review"},{title:"Year End Result",id:"evaluation"}],isSubmitted:!1,currentPart:{title:null,id:null},scoreCards:[],total_score_exec:"30",total_score_top:"40",rating:[],approved_at:"",approved_sv_at:null,agree_at:null,approved_hod_at:null,submit_at:null,isApproveSHR:!1,isApproveHOD:!1,isApproveSV:!1,disableRating:!0}},computed:{isShowSelfScore(){const e=["evaluation"];return e.includes(this.currentPart.id)},isReadOnly(){const e=["evaluation"];return e.includes(this.currentPart.id)},isShowAchievement(){const e=["review","evaluation"];return e.includes(this.currentPart.id)},isEnglish(){return"en"===this.$i18n.locale},...Object(b["c"])(["roles","userDetails"])},watch:{currentPart:{handler(e){this.whichPartNow(e)}}},mounted(){this.getScoreRating(),this.currentPart=this.allPart[0],this.checkSupervisorStatus(),null!==this.$route.params.performance_id&&(this.userId=this.$route.params.id.toString(),this.currentUser())},methods:{getScoreRating(){this.$axios.get(this.$baseUrl+"/rating/getAll").then(e=>{this.rating=e.data.data})},currentUser(){const e=new FormData;this.$axios.get(`${this.$baseUrl}/supervisor/getEmployee?user_id=${this.userId}`,e).then(e=>{this.subsidiary_id=e.data.data.employee.business_unit,this.grade_set_id=e.data.data.grade_set_id,this.weightage()})},weightage(){const e=new URLSearchParams;e.append("subsidiary_id",this.subsidiary_id),e.append("role_id",this.grade_set_id),this.$axios.get(this.$baseUrl+"/weightage/get_role_percentage",{params:e}).then(e=>{this.kra_weightage=e.data.data.key_result_area})},checkSupervisorStatus(){this.$axios.get(`${this.$baseUrl}/supervisor/checkSupervisory?performance_id=${this.performance_id}&user_id=${this.userDetails.user_id}`).then(e=>{this.isSupervisor=e.data.data.status.is_supervisor})},toggleInput(){this.disableRating=!this.disableRating},whichPartNow(e=this.currentPart){switch(e.id){case"setKra":this.getPlanning();break;case"review":this.getReview();break;case"evaluation":this.getResult();break;default:}},removeSpecificScoreBoard(e){const t=new FormData;t.append("objective_id",e.id);const i={method:"post",url:this.$baseUrl+"/kra/delete_objective",data:t};this.$axios(i).then(()=>{this.whichPartNow()}).catch(t=>{this.scoreCards.splice(e.index,1)})},removeSpecificKRa(e,t){const i=new FormData;i.append("kra_id",t.id);const a={method:"post",url:this.$baseUrl+"/kra/delete_kra",data:i};this.$axios(a).then(()=>{this.whichPartNow()}).catch(()=>{this.scoreCards[e.index].KRA.splice(t.index,1)})},removeSpecificTarget(e,t,i){this.scoreCards[e.index].KRA[t.index].target.splice(i.index,1)},addKRA(e){const t={id:"KRA"+this.generateRandomString(),visible:!1,description:null,remark:null,self_score:0,target:{id:"target"+this.generateRandomString(),measurement:null,target:null,due:null},achievement:{tracking:null,achievement:null,file:null}};this.scoreCards[e.index].KRA.push(t)},generateRandomString(){return(+new Date*Math.random()).toString(36).substring(0,6)},addScoreBoard(){const e={id:"ScoreBoard"+this.generateRandomString(),visible:!1,title:"Objective / Initiative",description:null,KRA:[{id:"KRA"+this.generateRandomString(),visible:!1,description:null,remark:null,self_score:0,target:{id:"target"+this.generateRandomString(),visible:!1,measurement:null,target:null,due:null},achievement:{tracking:null,achievement:null,file:null}}]};this.scoreCards.push(e)},getPlanning(){const e={method:"get",url:`${this.$baseUrl}/kra/get_planning?user_id=${this.userId}`};this.$axios(e).then(e=>{const t=e.data;if(t.success){const e=t.data.objective;if(e.length>0){this.isSubmitted=1===t.data.submitted;const i=[];e.forEach((e,t)=>{const a=v.a.cloneDeep(this.scoreCards[t]);let s=!1;this.scoreCards.length>0&&(s=a.visible);const r=e.key_result_area;i.push({id:e.objective_id,visible:s,title:"Objective / Initiative",description:e.objective_name,KRA:[]}),r.forEach((e,a)=>{const s=e.target;i[t].KRA.push({id:e.kra_id,visible:!1,description:e.kra_name,remark:s.remarks,target:{id:s.id,visible:!1,measurement:s.measurement,target:s.target,due:s.due_date,isFileKra:s.file},achievement:{tracking:null,achievement:null,file:null,self_score:null}})})}),this.scoreCards=i}else this.scoreCards=[]}}).catch(()=>{})},getReview(){const e={method:"get",url:`${this.$baseUrl}/kra/get_review?user_id=${this.userId}`};this.$axios(e).then(e=>{const t=e.data;if(t.success){const e=t.data.objective;if(e.length>0){this.isSubmitted=1===t.data.submitted;const i=[];e.forEach((e,t)=>{const a=v.a.cloneDeep(this.scoreCards[t]);let s=!1;this.scoreCards.length>0&&(s=a.visible);const r=e.key_result_area;i.push({id:e.objective_id,visible:s,title:"Objective / Initiative",description:e.objective_name,KRA:[]}),r.forEach((e,a)=>{const s=e.achievement;let r=!1;if(void 0!==this.scoreCards[t].KRA[a]){const e=v.a.cloneDeep(this.scoreCards[t].KRA[a]);this.scoreCards.length>0&&(r=void 0!==e.visible&&e.visible)}i[t].KRA.push({id:e.kra_id,visible:r,description:e.kra_name,remark:s.remarks,self_score:null===s.rating?0:s.rating,target:{id:s.id,visible:!1,measurement:s.measurement,target:s.target,due:s.due_date},achievement:{tracking:s.tracking,achievement:s.achievement,file:null,isFile:s.file,achievement_to_date:s.achievement_to_date}})})}),this.scoreCards=i}else this.scoreCards=[]}})},getResult(){const e={method:"get",url:`${this.$baseUrl}/kra/get_result?user_id=${this.userId}&cycle_id=${this.performance_id}`};this.$axios(e).then(e=>{const t=e.data;if(t.success){const i=t.data.objective;if(i.length>0){this.isSubmitted=1===t.data.submitted;const a=[];switch(i.forEach((e,t)=>{const i=v.a.cloneDeep(this.scoreCards[t]);let s=!1;this.scoreCards.length>0&&(s=i.visible);const r=e.key_result_area;a.push({id:e.objective_id,visible:s,title:"Objective / Initiative",description:e.objective_name,KRA:[]}),r.forEach((e,i)=>{const s=e.result;let r=!1;if(void 0!==this.scoreCards[t].KRA[i]){const e=v.a.cloneDeep(this.scoreCards[t].KRA[i]);this.scoreCards.length>0&&(r=void 0!==e.visible&&e.visible)}a[t].KRA.push({id:e.kra_id,visible:r,remark:s.remarks,description:e.kra_name,self_score:null===s.rating?0:s.rating,manager_rating:s.manager_rating,target:{id:s.id,visible:!1,measurement:s.measurement,target:s.target,due:s.due_date},achievement:{tracking:s.tracking,achievement:s.achievement,yearachievement:s.achievement,resultfile:null,isFileResult:s.file},result:{id:s.id}})})}),this.scoreCards=a,this.approved_at=e.data.data.approved_at,this.approved_sv_at=e.data.data.approved_sv_at,this.agree_at=e.data.data.agree_at,this.approved_hod_at=e.data.data.approved_hod_at,this.submit_at=e.data.data.submit_at,this.roles.selectedRole){case 1:null!==this.agree_at&&null===this.approved_at&&(this.isApproveSHR=!0);break;case 3:null!==this.submit_at&&null===this.agree_at&&(this.isApproveSV=!0);break;case 4:null!==this.submit_at&&null===this.agree_at&&(this.isApproveSV=!0);break;case 5:null!==this.agree_at&&null===this.approved_hod_at&&(this.isApproveHOD=!0);break;default:break}}else this.scoreCards=[]}}).catch(e=>{})},checkIfNull(e){return null!==e&&void 0!==e?e:""},saveKra(){const e=this.$refs.validateKRA.length;this.$refs.validateKRA.forEach((t,i)=>{this.$refs.validateKRA[i].validate().then(t=>{if(i===e-1)if(t){if(this.scoreCards.length>0){const e=new FormData,t=[];this.scoreCards.forEach((e,i)=>{t.push({objective_id:e.id,objective_name:e.description,kra:[]});const a=e.KRA;a.forEach(e=>{const a=e.target;t[i].kra.push({kra_id:e.id,kra_name:e.description,type:"planning",target:{target_id:this.checkIfNull(a.id),measurement:this.checkIfNull(a.measurement),target:this.checkIfNull(a.target),due_date:this.checkIfNull(a.due),remarks:this.checkIfNull(e.remark)}})})});const i=JSON.stringify(t);e.append("input",i);const a={method:"post",url:this.$baseUrl+"/kra/store_planning",data:e};this.$axios(a).then(()=>{this.whichPartNow()})}}else alert("Please fill all required fields")})})},saveReview(){const e=this.$refs.validateKRA.length;this.$refs.validateKRA.forEach((t,i)=>{this.$refs.validateKRA[i].validate().then(t=>{i===e-1&&(t?this.scoreCards.forEach(e=>{const t=e.KRA;t.forEach(t=>{const{achievement:i}=t,{target:a}=t,s=new FormData;s.append("kra_id[]",t.id),void 0!==e.id&&null!==e.id&&s.append(`objective_id[${t.id}]`,e.id),void 0!==t.description&&null!==t.description&&s.append(`kra_name[${t.id}]`,t.description),void 0!==i.achievement&&null!==i.achievement&&s.append(`achievement[${t.id}]`,i.achievement),void 0!==i.achievement_to_date&&null!==i.achievement_to_date&&s.append(`achievement_to_date[${t.id}]`,i.achievement_to_date),void 0!==i.tracking&&null!==i.tracking&&s.append(`tracking[${t.id}]`,i.tracking),void 0!==t.remark&&null!==t.remark&&s.append(`remarks[${t.id}]`,t.remark),void 0!==Number(t.self_score)&&null!==Number(t.self_score)&&s.append(`rating[${t.id}]`,Number(t.self_score)),void 0!==a.measurement&&null!==a.measurement&&s.append(`measurement[${t.id}]`,a.measurement),void 0!==a.target&&null!==a.target&&s.append(`target[${t.id}]`,a.target),void 0!==a.due&&null!==a.due&&s.append(`due_date[${t.id}]`,a.due),i.file instanceof File&&s.append(`file[${t.id}]`,i.file);const r={method:"post",url:this.$baseUrl+"/kra/store_achievement",data:s};this.$axios(r).then(e=>{const t=e.data;t.success?this.whichPartNow():alert(t.message)})})}):alert("Please fill all required fields"))})})},saveResult(){const e=Promise.all(this.scoreCards.map(e=>{const t=e.KRA,i=Promise.all(t.map(t=>{const{achievement:i}=t,a=new FormData;a.append("kra_id[]",t.id),void 0!==e.id&&null!==e.id&&a.append(`objective_id[${t.id}]`,e.id),a.append("objective_name",e.description),null!==i.achievement&&void 0!==i.achievement&&a.append(`achievement[${t.id}]`,i.achievement),null!==i.tracking&&void 0!==i.tracking&&a.append(`tracking[${t.id}]`,i.tracking),null!==t.remark&&void 0!==t.remark&&a.append(`remarks[${t.id}]`,t.remark),null!==Number(t.self_score)&&void 0!==Number(t.self_score)&&a.append(`rating[${t.id}]`,Number(t.self_score)),this.updateManagerScore(t.result.id,t.manager_rating);const s={method:"post",url:this.$baseUrl+"/kra/store_result",data:a};return this.$axios(s).then(e=>{const t=e.data;return t.success&&this.whichPartNow(),e})}));return i}));e.then(()=>{this.$toast({component:k["a"],props:{title:this.$t("Manager score for KRA successfully saved")+"!",icon:"CheckCircleIcon",variant:"success",titleColor:"#000"}},{position:"top-right",type:"info"})})},submitResult(){const e={method:"post",url:this.$baseUrl+"/kra/submit_result"};this.$axios(e).then(e=>{const t=e.data;t.success?this.whichPartNow():alert(t.message)}).catch(()=>{})},submitKra(){const e=this.$refs.validateKRA.length;this.$refs.validateKRA.forEach((t,i)=>{this.$refs.validateKRA[i].validate().then(t=>{if(i===e-1)if(t){const e={method:"post",url:this.$baseUrl+"/kra/submit_planning"};this.$axios(e).then(()=>{this.whichPartNow()}).catch(()=>{})}else alert("Please fill all required fields")})})},updateManagerScore(e,t){const i=new FormData;i.append("user_id",this.userId),i.append("result_id",e),i.append("manager_rating",t),i.append("current_role",this.roles.selectedRole);const a={method:"post",url:this.$baseUrl+"/manager/kra_manager_score_store",data:i};this.$axios(a).then(()=>{this.whichPartNow("setKra")}).catch(()=>{})},submitReview(){const e=this.$refs.validateKRA.length;this.$refs.validateKRA.forEach((t,i)=>{this.$refs.validateKRA[i].validate().then(t=>{if(i===e-1)if(t){const e={method:"post",url:this.$baseUrl+"/kra/submit_review"};this.$axios(e).then(e=>{const t=e.data;t.success?this.whichPartNow():alert(t.message)}).catch(()=>{})}else alert("Please fill all required fields")})})}}},C=$,y=(i("9b37"),i("2877")),S=Object(y["a"])(C,a,s,!1,null,"1863e73e",null);t["default"]=S.exports}}]);
//# sourceMappingURL=chunk-198aeab0.c3ff175c.js.map